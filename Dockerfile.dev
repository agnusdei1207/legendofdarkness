FROM rust:1.85-bookworm

# 시스템 패키지 설치
RUN apt update && apt install -y \
    pkg-config \
    libssl-dev \
    postgresql-client \
    && rm -rf /var/lib/apt/lists/*

# Rust Nightly 설정 (Leptos 0.8 최적화)
RUN rustup default nightly
RUN rustup target add wasm32-unknown-unknown

# Rust 도구 설치
RUN cargo install cargo-leptos --version 0.2.24 --locked
RUN cargo install sqlx-cli --no-default-features --features postgres --locked

# 작업 디렉토리
WORKDIR /workspace

# 기본 명령어
CMD ["cargo", "leptos", "watch"]
