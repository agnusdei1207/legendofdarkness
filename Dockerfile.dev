FROM rust:latest

# Install system dependencies for Bevy
RUN apt update && apt install -y \
    pkg-config \
    libasound2-dev \
    libudev-dev \
    libxkbcommon-dev \
    libwayland-dev \
    libx11-dev \
    libxcursor-dev \
    libxrandr-dev \
    libxi-dev \
    libgl1-mesa-dev \
    && rm -rf /var/lib/apt/lists/*

# Install toolchains and CLI tools
RUN rustup target add wasm32-unknown-unknown
RUN cargo install sqlx-cli --no-default-features --features postgres
RUN cargo install trunk

WORKDIR /workspace

# Set up cargo caching
ENV CARGO_HOME=/usr/local/cargo
